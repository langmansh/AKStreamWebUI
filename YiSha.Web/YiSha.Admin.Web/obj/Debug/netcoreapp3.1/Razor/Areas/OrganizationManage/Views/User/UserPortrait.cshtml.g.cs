#pragma checksum "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "cd422f31ece0fffa4a5cbafdfab92e78baf76816"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Areas_OrganizationManage_Views_User_UserPortrait), @"mvc.1.0.view", @"/Areas/OrganizationManage/Views/User/UserPortrait.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
#nullable restore
#line 3 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc.ViewFeatures;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Util;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Util.Extension;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Util.Model;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Enum;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Enum.OrganizationManage;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\_ViewImports.cshtml"
using YiSha.Web.Code;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"cd422f31ece0fffa4a5cbafdfab92e78baf76816", @"/Areas/OrganizationManage/Views/User/UserPortrait.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"e45dbd51f3d139278b58e1807e343bf3fa8e8229", @"/Areas/OrganizationManage/_ViewImports.cshtml")]
    public class Areas_OrganizationManage_Views_User_UserPortrait : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 1 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
  
    Layout = "~/Views/Shared/_FormWhite.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n");
            DefineSection("header", async() => {
                WriteLiteral("\r\n    ");
#nullable restore
#line 7 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
Write(BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/cropbox/1.0/cropbox.min.css")));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n    ");
#nullable restore
#line 8 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
Write(BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/cropbox/1.0/cropbox.min.js")));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n");
            }
            );
            WriteLiteral(@"
<div class=""container"">
    <div class=""imageBox"">
        <div class=""thumbBox""></div>
        <div class=""spinner"" style=""display: none"">Loading...</div>
    </div>
    <div class=""action"">
        <div class=""new-contentarea tc"">
            <a href=""javascript:void(0)"" class=""upload-img""> <label for=""avatar"">上传图像</label> </a>
            <input type=""file"" id=""portrait"" accept=""image/*"" />
        </div>
        <input type=""button"" id=""btnCrop"" class=""Btnsty_peyton"" value=""裁切"" />
        <input type=""button"" id=""btnZoomIn"" class=""Btnsty_peyton"" value=""+"" />
        <input type=""button"" id=""btnZoomOut"" class=""Btnsty_peyton"" value=""-"" />
        <input type=""button"" id=""btnSave"" class=""Btnsty_peyton"" value=""提交"" />
    </div>
    <div class=""cropped""></div>
</div>

<script type=""text/javascript"">
    var id = ys.request(""id"");
    var cropper;
    var imgFileName;

    $(function () {
        var portrait = '");
#nullable restore
#line 35 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
                   Write(ViewBag.OperatorInfo.Portrait);

#line default
#line hidden
#nullable disable
            WriteLiteral("\';\r\n        if (ys.isNullOrEmpty(portrait)) {\r\n            portrait = ctx + \'image/portrait.png\';\r\n        }\r\n        else {\r\n            portrait = \'");
#nullable restore
#line 40 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
                   Write(GlobalContext.SystemConfig.ApiSite);

#line default
#line hidden
#nullable disable
            WriteLiteral(@"' + portrait;
        }
        var options = {
            thumbBox: '.thumbBox',
            spinner: '.spinner',
            imgSrc: portrait
        };
        cropper = $('.imageBox').cropbox(options);
        $('#portrait').on('change', function () {
            var file = this.files[0];
            var reader = new FileReader();
            reader.onload = function (e) {
                options.imgSrc = e.target.result;
                //根据MIME判断上传的文件是不是图片类型
                if ((options.imgSrc).indexOf(""image/"") == -1) {
                    ys.msgError(""文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。"");
                } else {
                    cropper = $('.imageBox').cropbox(options);
                }
            }
            reader.readAsDataURL(file);
            imgFileName = file.name;
        });
        $('#btnSave').on('click', function () {
            saveForm(parent.layer.getFrameIndex(window.name));
        });
        $('#btnCrop').on('click', function () {
           ");
            WriteLiteral(@" if (!checkImageFileName()) {
                return;
            }
            var img = cropper.getDataURL();
            $('.cropped').html('');
            $('.cropped').append('<img src=""' + img + '"" align=""absmiddle"" style=""width:64px;margin-top:4px;border-radius:64px;box-shadow:0px 0px 12px #7E7E7E;"" ><p>64px*64px</p>');
            $('.cropped').append('<img src=""' + img + '"" align=""absmiddle"" style=""width:128px;margin-top:4px;border-radius:128px;box-shadow:0px 0px 12px #7E7E7E;""><p>128px*128px</p>');
            $('.cropped').append('<img src=""' + img + '"" align=""absmiddle"" style=""width:180px;margin-top:4px;border-radius:180px;box-shadow:0px 0px 12px #7E7E7E;""><p>180px*180px</p>');
        });
        $('#btnZoomIn').on('click', function () {
            cropper.zoomIn();
        });
        $('#btnZoomOut').on('click', function () {
            cropper.zoomOut();
        });
    });

    function saveForm(index) {
        if (!checkImageFileName()) {
            return;
        }");
            WriteLiteral("\r\n        var img = cropper.getBlob();\r\n        var formdata = new FormData();\r\n        formdata.append(\"fileList\", img, imgFileName);\r\n        ys.ajaxUploadFile({\r\n            url: \'");
#nullable restore
#line 92 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
             Write(GlobalContext.SystemConfig.ApiSite);

#line default
#line hidden
#nullable disable
            WriteLiteral("\' + \'/File/UploadFile?fileModule=");
#nullable restore
#line 92 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
                                                                                 Write(UploadFileType.Portrait.ParseToInt());

#line default
#line hidden
#nullable disable
            WriteLiteral(@"',
            data: formdata,
            success: function (obj) {
                if (obj.Tag == 1) {
                    saveUserPortrait(obj);
                }
                else {
                    ys.msgError(obj.Message);
                }
            }
        })
    }

    function saveUserPortrait(data) {
        var postData = {};
        postData.Id = id;
        postData.Portrait = data.Data;
        ys.ajax({
            url: '");
#nullable restore
#line 110 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
             Write(Url.Content("~/OrganizationManage/User/ChangeUserJson"));

#line default
#line hidden
#nullable disable
            WriteLiteral("\',\r\n            type: \"post\",\r\n            data: postData,\r\n            success: function (obj) {\r\n                if (obj.Tag == 1) {\r\n                    ys.msgSuccess(obj.Message);\r\n                    $(\"#portrait\", parent.document).attr(\"src\", \'");
#nullable restore
#line 116 "E:\源码\AKStreamWebUI\AKStreamWebUI\YiSha.Web\YiSha.Admin.Web\Areas\OrganizationManage\Views\User\UserPortrait.cshtml"
                                                            Write(GlobalContext.SystemConfig.ApiSite);

#line default
#line hidden
#nullable disable
            WriteLiteral(@"' + data.Data);
                    ys.closeDialog();
                }
                else {
                    ys.msgError(obj.Message);
                }
            }
        });
    }

    function checkImageFileName() {
        if (ys.isNullOrEmpty(imgFileName)) {
            ys.msgError(""请先上传图片"");
            return false;
        }
        else {
            return true;
        }
    }
</script>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public Microsoft.AspNetCore.Hosting.IWebHostEnvironment HostingEnvironment { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
